<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Multicore Round-robin Scheduling."><title>project1::rr - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-0ef3deca4ed45ad8.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../../static.files/light-f501212b8b071243.css"><link rel="stylesheet" disabled href="../../static.files/dark-e92fc12c34ff89d3.css"><link rel="stylesheet" disabled href="../../static.files/ayu-a0090c8b1ced384f.css"><script src="../../static.files/storage-3891ce972e3a2bf8.js"></script><script defer src="../../static.files/main-bfa4087bf2db080e.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../project1/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../project1/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Module rr</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../index.html">project1</a>::<wbr><a class="mod" href="#">rr</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../src/project1/rr.rs.html#1-92">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Multicore Round-robin Scheduling.</p>
<p>In this part, you will implement round robin scheduler.
Round robin is a scheduler that assigns equal amount of time slice into threads in circular order.
When time slice is expired, the scheduler kicks out the thread from the running state
and push back to the scheduling queue.</p>
<h3 id="background"><a href="#background">Background</a></h3>
<p>Thread is an abstraction of a cpu core.
Through the thread abstraction, the operating system can run multiple tasks
on a cpu core.</p>
<p>KeOS already implemented some thread functionalities like thread creation,
thread switching.
You can create a new thread with <a href="../../keos/thread/struct.ThreadBuilder.html"><code>ThreadBuilder</code></a>. You provide a function to be run on
the thread as an argument to <a href="../../keos/thread/struct.ThreadBuilder.html#method.spawn"><code>ThreadBuilder::spawn</code></a>.
When the first time the thread runs, the function executed.
When the function is terminated, the thread also be terminated.
Each thread, therefore, acts like a mini-program running inside the kernel.</p>
<p>At any given time, exactly one thread runs and the rest, if any, become inactive.
The scheduler decides which thread to run next by calling <a href="../../keos/thread/scheduler/trait.Scheduler.html#tymethod.next_to_run"><code>Scheduler::next_to_run</code></a>.
If no thread is ready to run at any given time, then the special idle thread runs.</p>
<p>The magics of a context switch lies on <a href="../../keos/thread/struct.Thread.html#method.run"><code>Thread::run</code></a>. It saves the state of the
currently running thread and restores the state of the thread we’re switching to.</p>
<h3 id="important-notes"><a href="#important-notes">IMPORTANT NOTES</a></h3>
<p>In KeOS, each thread is assigned a <a href="../../keos/thread/constant.STACK_SIZE.html"><code>STACK_SIZE</code></a>-size execution stack. The KeOS try to detect
the stack overflow, however it is not perfect. If the stack is overflowed, you can encounter a
mysterious kernel panics.
To prevent the such situation, DO NOT DECLARE large data structures (e.g. <code>let v: [u8; 0x200000];</code>)
and allocate them on heap through <a href="https://doc.rust-lang.org/alloc/boxed/struct.Box.html"><code>Box</code></a>.</p>
<h3 id="implementation-requirements"><a href="#implementation-requirements">Implementation requirements</a></h3>
<p>In this projects, you implements a round robin scheduler with 5ms time slices.
Note that <a href="../../keos/thread/scheduler/trait.Scheduler.html#tymethod.timer_tick" title="Scheduler::timer_tick"><code>Scheduler::timer_tick</code></a> is called at every 1ms on each cpu.
When a new thread is reached, it must be pushed back to the current scheduling queue.
You are required to implement passive job stealing; when there is no task in the current runqueue, then steal from the other.</p>
<h3 id="implementation-order"><a href="#implementation-order">Implementation Order</a></h3>
<p>You will fill the <a href="../../keos/thread/scheduler/trait.Scheduler.html"><code>Scheduler</code></a> trait implementor for <code>RoundRobin</code> struct.
Fill the <code>todo!()</code>s of RoundRobin scheduler.
Read the documentation of <a href="../../keos/thread/scheduler/trait.Scheduler.html"><code>Scheduler</code></a> to understand what each member does.
The project is straightforward. You will meet several <code>todo!()</code>s during implementation,
and replace those <code>todo!()</code>s to your implementation.</p>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left"><a class="struct" href="struct.RoundRobin.html" title="struct project1::rr::RoundRobin">RoundRobin</a></div><div class="item-right docblock-short">A round robin scheduler.</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="project1" data-themes="" data-resource-suffix="" data-rustdoc-version="1.69.0-nightly (585f3eef2 2023-02-11)" data-search-js="search-28136cea55c34037.js" data-settings-js="settings-f0c5c39777a9a2f6.js" data-settings-css="settings-0bcba95ff279c1db.css" ></div></body></html>